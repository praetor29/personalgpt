{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createUseLang = void 0;\nconst useGlobalState_1 = require(\"powerhooks/useGlobalState\");\nconst urlSearchParams_1 = require(\"powerhooks/tools/urlSearchParams\");\nconst id_1 = require(\"tsafe/id\");\nconst symToStr_1 = require(\"tsafe/symToStr\");\nconst typeGuard_1 = require(\"tsafe/typeGuard\");\nfunction createUseLang(params) {\n  const {\n    languages,\n    fallbackLanguage\n  } = params;\n  const name = \"lang\";\n  const {\n    useLang,\n    $lang\n  } = (0, useGlobalState_1.createUseGlobalState)({\n    name,\n    \"initialState\": (() => {\n      const lang = getLanguageBestApprox({\n        \"languageLike\": navigator.language,\n        languages\n      });\n      if (lang === undefined) {\n        return fallbackLanguage;\n      }\n      return lang;\n    })(),\n    \"doPersistAcrossReloads\": true\n  });\n  {\n    const next = lang => document.documentElement.setAttribute(name, lang);\n    next($lang.current);\n    $lang.subscribe(next);\n  }\n  read_url: {\n    const result = (0, urlSearchParams_1.retrieveParamFromUrl)({\n      \"url\": window.location.href,\n      name\n    });\n    if (result.wasPresent) {\n      (0, urlSearchParams_1.updateSearchBarUrl)(result.newUrl);\n      if (!(0, typeGuard_1.typeGuard)(result.value, (0, id_1.id)(languages).includes(result.value))) {\n        break read_url;\n      }\n      $lang.current = result.value;\n    }\n  }\n  [...languages, undefined].forEach(lang => {\n    const link = document.createElement(\"link\");\n    link.rel = \"alternate\";\n    link.hreflang = lang === undefined ? \"x-default\" : lang;\n    link.href = lang === undefined ? window.location.href : (0, urlSearchParams_1.addParamToUrl)({\n      \"url\": window.location.href,\n      name,\n      \"value\": lang\n    }).newUrl;\n    document.getElementsByTagName(\"head\")[0].appendChild(link);\n  });\n  function getLanguageBestApprox(params) {\n    const {\n      languages,\n      languageLike\n    } = params;\n    scope: {\n      const lang = languages.find(lang => lang.toLowerCase() === languageLike.toLowerCase());\n      if (lang === undefined) {\n        break scope;\n      }\n      return lang;\n    }\n    scope: {\n      const iso2LanguageLike = languageLike.split(\"-\")[0].toLowerCase();\n      const lang = languages.find(lang => lang.toLowerCase().includes(iso2LanguageLike));\n      if (lang === undefined) {\n        break scope;\n      }\n      return lang;\n    }\n    return undefined;\n  }\n  return {\n    useLang,\n    [(0, symToStr_1.symToStr)({\n      $lang\n    })]: (0, id_1.id)($lang)\n  };\n}\nexports.createUseLang = createUseLang;","map":{"version":3,"names":["Object","defineProperty","exports","value","createUseLang","useGlobalState_1","require","urlSearchParams_1","id_1","symToStr_1","typeGuard_1","params","languages","fallbackLanguage","name","useLang","$lang","createUseGlobalState","lang","getLanguageBestApprox","navigator","language","undefined","next","document","documentElement","setAttribute","current","subscribe","read_url","result","retrieveParamFromUrl","window","location","href","wasPresent","updateSearchBarUrl","newUrl","typeGuard","id","includes","forEach","link","createElement","rel","hreflang","addParamToUrl","getElementsByTagName","appendChild","languageLike","scope","find","toLowerCase","iso2LanguageLike","split","symToStr"],"sources":["C:/Users/prana/repos/personalgpt/.yarn/__virtual__/i18nifty-virtual-f94293219d/3/AppData/Local/Yarn/Berry/cache/i18nifty-npm-1.6.2-79bdda185a-10c0.zip/node_modules/i18nifty/useLang_spa.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createUseLang = void 0;\nconst useGlobalState_1 = require(\"powerhooks/useGlobalState\");\nconst urlSearchParams_1 = require(\"powerhooks/tools/urlSearchParams\");\nconst id_1 = require(\"tsafe/id\");\nconst symToStr_1 = require(\"tsafe/symToStr\");\nconst typeGuard_1 = require(\"tsafe/typeGuard\");\nfunction createUseLang(params) {\n    const { languages, fallbackLanguage } = params;\n    const name = \"lang\";\n    const { useLang, $lang } = (0, useGlobalState_1.createUseGlobalState)({\n        name,\n        \"initialState\": (() => {\n            const lang = getLanguageBestApprox({\n                \"languageLike\": navigator.language,\n                languages\n            });\n            if (lang === undefined) {\n                return fallbackLanguage;\n            }\n            return lang;\n        })(),\n        \"doPersistAcrossReloads\": true\n    });\n    {\n        const next = (lang) => document.documentElement.setAttribute(name, lang);\n        next($lang.current);\n        $lang.subscribe(next);\n    }\n    read_url: {\n        const result = (0, urlSearchParams_1.retrieveParamFromUrl)({\n            \"url\": window.location.href,\n            name\n        });\n        if (result.wasPresent) {\n            (0, urlSearchParams_1.updateSearchBarUrl)(result.newUrl);\n            if (!(0, typeGuard_1.typeGuard)(result.value, (0, id_1.id)(languages).includes(result.value))) {\n                break read_url;\n            }\n            $lang.current = result.value;\n        }\n    }\n    [...languages, undefined].forEach(lang => {\n        const link = document.createElement(\"link\");\n        link.rel = \"alternate\";\n        link.hreflang = lang === undefined ? \"x-default\" : lang;\n        link.href =\n            lang === undefined\n                ? window.location.href\n                : (0, urlSearchParams_1.addParamToUrl)({\n                    \"url\": window.location.href,\n                    name,\n                    \"value\": lang\n                }).newUrl;\n        document.getElementsByTagName(\"head\")[0].appendChild(link);\n    });\n    function getLanguageBestApprox(params) {\n        const { languages, languageLike } = params;\n        scope: {\n            const lang = languages.find(lang => lang.toLowerCase() === languageLike.toLowerCase());\n            if (lang === undefined) {\n                break scope;\n            }\n            return lang;\n        }\n        scope: {\n            const iso2LanguageLike = languageLike.split(\"-\")[0].toLowerCase();\n            const lang = languages.find(lang => lang.toLowerCase().includes(iso2LanguageLike));\n            if (lang === undefined) {\n                break scope;\n            }\n            return lang;\n        }\n        return undefined;\n    }\n    return {\n        useLang,\n        [(0, symToStr_1.symToStr)({ $lang })]: (0, id_1.id)($lang)\n    };\n}\nexports.createUseLang = createUseLang;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}